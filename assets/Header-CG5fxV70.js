import{r as l,j as e,u as ve,L as I,l as we,d as ye}from"./iframe-CgUoK-hQ.js";import{i as Se,s as ke}from"./vehicleService-BAIAK0V_.js";import{u as Ve,g as Le}from"./useSupabaseRating-BGhOdxzs.js";import{v as k,s as X,c as Me,a as he}from"./index-BFhOOLG3.js";import{B as S}from"./Button-iG14NSVa.js";import{E as $e}from"./ExitIntentModal-ByTbEhd_.js";import{O as W}from"./OptimizedImage-Q59EmT4r.js";import"./DealerLocatorMap-wgFiVR55.js";import"./MakeOfferModal-SLPWgwNL.js";import"./OfferNegotiation-Di3ElQRW.js";import{D as Re}from"./DealerMapModal-Cjp6PwBv.js";import{X as Y}from"./x-bi8nA3M3.js";import{D as He}from"./dollar-sign-DTx8annB.js";import{S as ie}from"./star-D02l7Ud8.js";import{G as ze}from"./gauge-BzAhuILC.js";import{F as Ae}from"./fuel-DVaZkBng.js";import{c as Ie}from"./createLucideIcon-Da5CRH6t.js";import{C as le}from"./check-BwVsgOuI.js";import{M as de}from"./minus-gTYdqDdB.js";import{C as ue}from"./clock-C01OFVsy.js";import{B}from"./bookmark-CfmFIeaY.js";import{C as ee}from"./car-6Y3oKaaK.js";import{T as Ee,M as De,L as Oe}from"./trash-2-DWs0kI9L.js";import{G as se}from"./git-compare-Bcn3hNhA.js";import{M as Fe}from"./map-pin-UJmpWtQ-.js";import{C as _e}from"./chevron-right-VVkz4baE.js";import{S as te}from"./search-sWyouRpI.js";import{P as ae}from"./plus-DlevoAlx.js";import{U as Ze}from"./user-BmTsGj7S.js";const Pe=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],Te=Ie("settings",Pe),Be=(t,n)=>k.find(c=>c.make===t&&c.model===n),Ue={"avatar-family":{make:"Honda",model:"Pilot",fallback:he},"avatar-adventure":{make:"Jeep",model:"Wrangler",fallback:he},"avatar-luxury":{make:"Mercedes-Benz",model:"S-Class",fallback:X},"avatar-eco-friendly":{make:"Tesla",model:"Model 3",fallback:X},"avatar-performance":{make:"Porsche",model:"911",fallback:Me},"avatar-commuter":{make:"Toyota",model:"Camry",fallback:X},"avatar-value":{make:"Honda",model:"Civic",fallback:X}},re=t=>{if(!t||t==="initials")return null;const n=Ue[t];return n&&(Be(n.make,n.model)||n.fallback[0])?.image||null},pe=t=>{if(!t)return"U";const n=t.split(" ");return n.length>=2?`${n[0][0]}${n[1][0]}`.toUpperCase():n[0].substring(0,2).toUpperCase()},oe="recentlyViewedVehicles",We=20,Ge=()=>{try{const t=localStorage.getItem(oe);return t?JSON.parse(t):[]}catch{return[]}},ys=t=>{try{const n=Ge(),c={id:t.id,name:`${t.year} ${t.make} ${t.model}`,slug:t.slug,image:t.image,price:t.priceMin,mileage:t.mileage,viewedAt:new Date().toISOString()},M=n.filter(x=>x.id!==t.id&&x.slug!==t.slug),H=[c,...M].slice(0,We);localStorage.setItem(oe,JSON.stringify(H))}catch(n){console.error("Error saving recently viewed vehicle:",n)}},Ye=()=>{try{localStorage.removeItem(oe)}catch(t){console.error("Error clearing recently viewed vehicles:",t)}},ge=({isOpen:t,onClose:n,vehicles:c})=>{const M=l.useRef(null);l.useEffect(()=>{const a=d=>{d.key==="Escape"&&n()};return t&&(document.addEventListener("keydown",a),document.body.style.overflow="hidden"),()=>{document.removeEventListener("keydown",a),document.body.style.overflow=""}},[t,n]);const H=a=>{a.target===a.currentTarget&&n()},x=a=>{const d=a.split(" ");if(d.length>=1&&/^\d{4}$/.test(d[0])&&d.length>=3){const b=parseInt(d[0]),o=d[1],u=d.slice(2).join(" ");let R=k.find(C=>Number(C.year)===b&&C.make.toLowerCase()===o.toLowerCase()&&C.model.toLowerCase()===u.toLowerCase());return R||(R=k.find(C=>C.make.toLowerCase()===o.toLowerCase()&&C.model.toLowerCase()===u.toLowerCase())),R}else if(d.length>=2){const b=d[0],o=d.slice(1).join(" ");return k.find(u=>u.make.toLowerCase()===b.toLowerCase()&&u.model.toLowerCase()===o.toLowerCase())}return null},h=l.useMemo(()=>c.map(a=>({...a,details:x(a.name)})),[c]),f=l.useMemo(()=>[{category:"Pricing",specs:[{name:"Starting MSRP",values:h.map(a=>a.details?.priceMin?`$${a.details.priceMin.toLocaleString()}`:"—"),highlight:"lower"},{name:"Price Range",values:h.map(a=>a.details?.priceRange||"—")}]},{category:"Ratings",specs:[{name:"C/D Rating",values:h.map(a=>a.details?.staffRating?`${a.details.staffRating.toFixed(1)}/10`:"—"),highlight:"higher"},{name:"Community Rating",values:h.map(a=>a.details?.communityRating?`${a.details.communityRating.toFixed(1)}/10`:"—"),highlight:"higher"}]},{category:"Performance",specs:[{name:"Horsepower",values:h.map(a=>a.details?.horsepower?`${a.details.horsepower} hp`:"—"),highlight:"higher"},{name:"Fuel Economy",values:h.map(a=>a.details?.mpg||"—"),highlight:"higher"},{name:"Drivetrain",values:h.map(a=>a.details?.drivetrain||"—")},{name:"Transmission",values:h.map(a=>a.details?.transmission||"—")}]},{category:"Details",specs:[{name:"Body Style",values:h.map(a=>a.details?.bodyStyle||"—")},{name:"Fuel Type",values:h.map(a=>a.details?.fuelType||"—")},{name:"Seating",values:h.map(a=>a.details?.seatingCapacity?`${a.details.seatingCapacity} passengers`:"—")},{name:"Cargo Space",values:h.map(a=>a.details?.cargoSpace?`${a.details.cargoSpace} cu ft`:"—"),highlight:"higher"}]},{category:"Awards",specs:[{name:"Editor's Choice",values:h.map(a=>a.details?.editorsChoice??!1)},{name:"10Best",values:h.map(a=>a.details?.tenBest??!1)},{name:"EV of the Year",values:h.map(a=>a.details?.evOfTheYear??!1)}]}],[h]),$=(a,d)=>{if(!d)return null;const b=a.map(o=>{if(typeof o=="string"){const u=o.match(/[\d,.]+/);return u?parseFloat(u[0].replace(/,/g,"")):null}return null}).map((o,u)=>({value:o,index:u})).filter(o=>o.value!==null);return b.length<2?null:d==="higher"?b.reduce((o,u)=>u.value>o.value?u:o).index:b.reduce((o,u)=>u.value<o.value?u:o).index};if(!t||c.length<2)return null;const y=(a,d=!1)=>a===!0?e.jsx("span",{className:"vehicle-compare-value vehicle-compare-value--yes",children:e.jsx(le,{size:18})}):a===!1?e.jsx("span",{className:"vehicle-compare-value vehicle-compare-value--no",children:e.jsx(de,{size:16})}):a===null||a==="—"?e.jsx("span",{className:"vehicle-compare-value vehicle-compare-value--na",children:e.jsx(de,{size:16})}):e.jsx("span",{className:`vehicle-compare-value vehicle-compare-value--text ${d?"vehicle-compare-value--best":""}`,children:a});return e.jsx("div",{className:"vehicle-comparison-modal",onClick:H,children:e.jsxs("div",{className:"vehicle-comparison-modal__content",ref:M,children:[e.jsxs("header",{className:"vehicle-comparison-modal__header",children:[e.jsxs("div",{className:"vehicle-comparison-modal__header-content",children:[e.jsx("h2",{className:"vehicle-comparison-modal__title",children:"Compare Vehicles"}),e.jsxs("p",{className:"vehicle-comparison-modal__subtitle",children:["Side-by-side comparison of ",c.length," vehicles"]})]}),e.jsx("button",{className:"vehicle-comparison-modal__close",onClick:n,"aria-label":"Close comparison",children:e.jsx(Y,{size:24})})]}),e.jsxs("div",{className:"vehicle-comparison-modal__body",children:[e.jsx("div",{className:"vehicle-comparison-modal__vehicles",children:h.map(a=>e.jsxs("div",{className:"vehicle-compare-card",children:[e.jsx("div",{className:"vehicle-compare-card__image",children:e.jsx(W,{src:a.details?.image||a.image,alt:a.name,width:200,height:130})}),e.jsxs("div",{className:"vehicle-compare-card__info",children:[e.jsx("h3",{className:"vehicle-compare-card__name",children:a.name}),e.jsxs("div",{className:"vehicle-compare-card__meta",children:[e.jsxs("span",{className:"vehicle-compare-card__price",children:[e.jsx(He,{size:14}),a.details?.priceMin?`$${a.details.priceMin.toLocaleString()}`:`$${a.price.toLocaleString()}`]}),a.details?.staffRating&&e.jsxs("span",{className:"vehicle-compare-card__rating",children:[e.jsx(ie,{size:14,fill:"currentColor"}),a.details.staffRating.toFixed(1)]})]}),a.details&&e.jsxs("div",{className:"vehicle-compare-card__specs",children:[a.details.horsepower&&e.jsxs("span",{className:"vehicle-compare-card__spec",children:[e.jsx(ze,{size:12}),a.details.horsepower," hp"]}),a.details.mpg&&e.jsxs("span",{className:"vehicle-compare-card__spec",children:[e.jsx(Ae,{size:12}),a.details.mpg]}),a.details.drivetrain&&e.jsxs("span",{className:"vehicle-compare-card__spec",children:[e.jsx(Te,{size:12}),a.details.drivetrain]})]})]})]},a.id))}),e.jsx("div",{className:"vehicle-comparison-table-wrapper",children:e.jsxs("table",{className:"vehicle-comparison-table",children:[e.jsx("thead",{className:"vehicle-comparison-table__head",children:e.jsxs("tr",{children:[e.jsx("th",{className:"vehicle-comparison-table__corner",children:"Specification"}),h.map(a=>e.jsxs("th",{className:"vehicle-comparison-table__vehicle-header",children:[a.details?.make," ",a.details?.model]},a.id))]})}),e.jsx("tbody",{className:"vehicle-comparison-table__body",children:f.map(a=>e.jsxs(e.Fragment,{children:[e.jsx("tr",{className:"vehicle-comparison-table__category-row",children:e.jsx("td",{colSpan:h.length+1,className:"vehicle-comparison-table__category",children:a.category})},a.category),a.specs.map(d=>{const j=$(d.values,d.highlight);return e.jsxs("tr",{className:"vehicle-comparison-table__spec-row",children:[e.jsx("td",{className:"vehicle-comparison-table__spec-name",children:d.name}),d.values.map((b,o)=>e.jsx("td",{className:`vehicle-comparison-table__spec-value ${j===o?"vehicle-comparison-table__spec-value--best":""}`,children:y(b,j===o)},o))]},d.name)})]}))})]})})]}),e.jsxs("footer",{className:"vehicle-comparison-modal__footer",children:[e.jsxs("div",{className:"vehicle-comparison-legend",children:[e.jsxs("span",{className:"vehicle-comparison-legend__item",children:[e.jsx(le,{size:16,className:"vehicle-comparison-legend__icon vehicle-comparison-legend__icon--yes"}),e.jsx("span",{children:"Yes"})]}),e.jsxs("span",{className:"vehicle-comparison-legend__item",children:[e.jsx(de,{size:16,className:"vehicle-comparison-legend__icon vehicle-comparison-legend__icon--na"}),e.jsx("span",{children:"Not Available"})]}),e.jsxs("span",{className:"vehicle-comparison-legend__item vehicle-comparison-legend__item--best",children:[e.jsx("span",{className:"vehicle-comparison-legend__best-indicator"}),e.jsx("span",{children:"Best in Category"})]})]}),e.jsx("p",{className:"vehicle-comparison-disclaimer",children:"Specifications shown are for base models. Verify with dealer for exact features."})]})]})})};ge.__docgenInfo={description:"",methods:[],displayName:"VehicleComparisonModal",props:{isOpen:{required:!0,tsType:{name:"boolean"},description:""},onClose:{required:!0,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},vehicles:{required:!0,tsType:{name:"Array",elements:[{name:"CompareVehicle"}],raw:"CompareVehicle[]"},description:""}}};const xe=({isOpen:t,onClose:n})=>{const{user:c,addSavedVehicle:M,removeSavedVehicle:H}=ve(),[x,h]=l.useState("recently-viewed"),[f,$]=l.useState([]),[y,a]=l.useState(!1),[d,j]=l.useState(!1),[b,o]=l.useState(""),[u,R]=l.useState(""),[C,z]=l.useState([]),[G,O]=l.useState([]),F=l.useRef(null),Z=l.useRef(null),[ne,q]=l.useState(!1),[A,Q]=l.useState(null),[w,E]=l.useState(!1),[V,P]=l.useState([]),[U,J]=l.useState(!1);l.useEffect(()=>{const s=localStorage.getItem("recentlyViewedVehicles");if(s)try{const r=JSON.parse(s);$(r.slice(0,10))}catch{$([])}},[t]);const i=()=>{Ye(),$([])},p=s=>{const r=s.split(" ");if(r.length>=1&&/^\d{4}$/.test(r[0])&&r.length>=3){const m=parseInt(r[0]),v=r[1],L=r.slice(2).join(" ");let g=k.find(N=>Number(N.year)===m&&N.make.toLowerCase()===v.toLowerCase()&&N.model.toLowerCase()===L.toLowerCase());return g||(g=k.find(N=>N.make.toLowerCase()===v.toLowerCase()&&N.model.toLowerCase()===L.toLowerCase())),g||(g=k.find(N=>N.make.toLowerCase()===v.toLowerCase()&&(N.model.toLowerCase().includes(L.toLowerCase())||L.toLowerCase().includes(N.model.toLowerCase())))),g}else if(r.length>=2){const m=r[0],v=r.slice(1).join(" ");let L=k.find(g=>g.make.toLowerCase()===m.toLowerCase()&&g.model.toLowerCase()===v.toLowerCase());if(L||(L=k.find(g=>g.make.toLowerCase()===m.toLowerCase()&&(g.model.toLowerCase().includes(v.toLowerCase())||v.toLowerCase().includes(g.model.toLowerCase())))),!L){const g=s.toLowerCase();L=k.find(N=>`${N.make} ${N.model}`.toLowerCase().includes(g)||g.includes(`${N.make} ${N.model}`.toLowerCase()))}return L}return null},D=c?.savedVehicles?.filter(s=>s.ownership==="want")||[],T=c?.savedVehicles?.filter(s=>s.ownership==="own")||[],ce=s=>{const r=s.target.value;if(o(r),r.length>=2){const _=k.filter(m=>`${m.year} ${m.make} ${m.model}`.toLowerCase().includes(r.toLowerCase())).slice(0,6);z(_)}else z([])},fe=s=>{const r=s.target.value;if(R(r),r.length>=2){const _=k.filter(m=>`${m.year} ${m.make} ${m.model}`.toLowerCase().includes(r.toLowerCase())).slice(0,6);O(_)}else O([])},je=s=>{M({id:`own-${s.id}`,name:`${s.year} ${s.make} ${s.model}`,ownership:"own",savedAt:new Date().toISOString()}),o(""),z([]),a(!1)},be=s=>{M({id:`want-${s.id}`,name:`${s.year} ${s.make} ${s.model}`,ownership:"want",savedAt:new Date().toISOString()}),R(""),O([]),j(!1)};l.useEffect(()=>{y&&F.current&&F.current.focus()},[y]),l.useEffect(()=>{d&&Z.current&&Z.current.focus()},[d]);const K=s=>{P(r=>r.includes(s)?r.filter(_=>_!==s):r.length>=3?r:[...r,s])},me=()=>{V.length>=2&&J(!0)},Ne=()=>x==="recently-viewed"?V.map(s=>f.find(r=>r.id===s)).filter(s=>s!==void 0):x==="want"?V.map(s=>{const r=D.find(m=>m.id===s);if(!r)return;const _=p(r.name);if(_)return{id:r.id,name:r.name,slug:_.slug,image:_.image,price:_.priceMin,viewedAt:r.savedAt?new Date(r.savedAt):new Date}}).filter(s=>s!==void 0):[];if(l.useEffect(()=>{E(!1),P([])},[x]),l.useEffect(()=>{const s=r=>{r.key==="Escape"&&n()};return t&&(document.addEventListener("keydown",s),document.body.style.overflow="hidden"),()=>{document.removeEventListener("keydown",s),document.body.style.overflow=""}},[t,n]),!t)return null;const Ce=[{id:"recently-viewed",label:"Recently Viewed",icon:e.jsx(ue,{size:16}),count:f.length},{id:"want",label:"Cars I Want",icon:e.jsx(B,{size:16}),count:D.length},{id:"own",label:"Cars I Own",icon:e.jsx(ee,{size:16}),count:T.length}];return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"saved-sidebar__overlay",onClick:n}),e.jsxs("aside",{className:"saved-sidebar",role:"dialog","aria-label":"Saved vehicles",children:[e.jsxs("div",{className:"saved-sidebar__header",children:[e.jsxs("div",{className:"saved-sidebar__header-content",children:[e.jsx(B,{size:20,fill:"currentColor",className:"saved-sidebar__header-icon"}),e.jsx("h2",{className:"saved-sidebar__title",children:"My Garage"})]}),e.jsx(S,{variant:"ghost",size:"small",className:"saved-sidebar__close",onClick:n,"aria-label":"Close sidebar",iconLeft:e.jsx(Y,{size:24})})]}),e.jsxs("div",{className:"saved-sidebar__welcome",children:[e.jsx("span",{className:"saved-sidebar__welcome-text",children:"Welcome!"}),e.jsx("p",{className:"saved-sidebar__welcome-desc",children:"Here are the cars you've viewed, followed or own."})]}),e.jsx("div",{className:"saved-sidebar__tabs",children:Ce.map(s=>e.jsxs("button",{className:`saved-sidebar__tab ${x===s.id?"saved-sidebar__tab--active":""}`,onClick:()=>h(s.id),children:[s.icon,e.jsx("span",{children:s.label}),s.count>0&&e.jsx("span",{className:"saved-sidebar__tab-count",children:s.count})]},s.id))}),e.jsxs("div",{className:"saved-sidebar__content",children:[x==="recently-viewed"&&e.jsx("div",{className:"saved-sidebar__section",children:f.length>0?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"saved-sidebar__section-header",children:[e.jsxs("span",{className:"saved-sidebar__section-title",children:["Recently Viewed (",f.length,")"]}),e.jsxs("div",{className:"saved-sidebar__section-actions",children:[e.jsx(S,{variant:"ghost",size:"small",className:"saved-sidebar__clear-btn",onClick:i,iconLeft:e.jsx(Ee,{size:14}),children:"Clear"}),f.length>=2&&(w?V.length>=2?e.jsxs(S,{variant:"primary",size:"small",className:"saved-sidebar__compare-action",onClick:me,iconLeft:e.jsx(se,{size:14}),children:["COMPARE (",V.length,")"]}):e.jsx(S,{variant:"ghost",size:"small",className:"saved-sidebar__section-link",onClick:()=>{E(!1),P([])},children:"Cancel"}):e.jsx(S,{variant:"ghost",size:"small",className:"saved-sidebar__section-link",onClick:()=>E(!0),iconLeft:e.jsx(se,{size:14}),children:"COMPARE"}))]})]}),w&&e.jsx("p",{className:"saved-sidebar__compare-hint",children:"Select 2-3 vehicles to compare"}),e.jsx("div",{className:"saved-sidebar__vehicles",children:f.map((s,r)=>{const _=p(s.name),m=V.includes(s.id);return e.jsxs("div",{className:`saved-sidebar__vehicle-container ${m?"saved-sidebar__vehicle-container--selected":""}`,children:[w&&e.jsx("button",{className:`saved-sidebar__compare-checkbox ${m?"saved-sidebar__compare-checkbox--checked":""}`,onClick:()=>K(s.id),"aria-label":m?"Remove from compare":"Add to compare",children:m&&e.jsx(le,{size:14})}),e.jsxs(I,{to:`/${s.slug}`,className:"saved-sidebar__vehicle",onClick:v=>{w?(v.preventDefault(),K(s.id)):n()},children:[e.jsx("div",{className:"saved-sidebar__vehicle-image",children:e.jsx(W,{src:s.image,alt:s.name,width:80,height:60})}),e.jsxs("div",{className:"saved-sidebar__vehicle-info",children:[e.jsx("span",{className:"saved-sidebar__vehicle-name",children:s.name}),e.jsxs("div",{className:"saved-sidebar__vehicle-meta",children:[e.jsxs("span",{className:"saved-sidebar__vehicle-price",children:["$",s.price.toLocaleString()]}),_?.staffRating&&e.jsxs("span",{className:"saved-sidebar__vehicle-rating",children:[e.jsx(ie,{size:12,fill:"currentColor"}),e.jsx("span",{children:_.staffRating.toFixed(1)}),e.jsx("span",{className:"saved-sidebar__vehicle-rating-label",children:"C/D"})]})]}),s.mileage&&e.jsxs("span",{className:"saved-sidebar__vehicle-mileage",children:[s.mileage.toLocaleString()," mi"]})]}),!w&&e.jsx("button",{className:`saved-sidebar__vehicle-favorite ${c?.savedVehicles?.some(v=>v.name===s.name)?"saved-sidebar__vehicle-favorite--active":""}`,onClick:v=>{if(v.preventDefault(),v.stopPropagation(),c?.savedVehicles?.some(g=>g.name===s.name)){const g=c?.savedVehicles?.find(N=>N.name===s.name);g&&H(g.id)}else M({id:`want-${s.id}-${Date.now()}`,name:s.name,ownership:"want",savedAt:new Date().toISOString()})},"aria-label":c?.savedVehicles?.some(v=>v.name===s.name)?"Remove from saved":"Save vehicle",children:e.jsx(B,{size:18,fill:c?.savedVehicles?.some(v=>v.name===s.name)?"currentColor":"none"})})]})]},`${s.id}-${r}`)})})]}):e.jsxs("div",{className:"saved-sidebar__empty",children:[e.jsx(ue,{size:48,className:"saved-sidebar__empty-icon"}),e.jsx("h3",{className:"saved-sidebar__empty-title",children:"No recently viewed"}),e.jsx("p",{className:"saved-sidebar__empty-desc",children:"Start browsing vehicles and they'll appear here."}),e.jsx(I,{to:"/vehicles",className:"saved-sidebar__empty-cta",onClick:n,children:"Browse Vehicles"})]})}),x==="want"&&e.jsxs("div",{className:"saved-sidebar__section",children:[D.length>0?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"saved-sidebar__section-header",children:[e.jsxs("span",{className:"saved-sidebar__section-title",children:["Cars I Want (",D.length,")"]}),e.jsx("div",{className:"saved-sidebar__section-actions",children:D.length>=2&&(w?V.length>=2?e.jsxs(S,{variant:"primary",size:"small",className:"saved-sidebar__compare-action",onClick:me,iconLeft:e.jsx(se,{size:14}),children:["COMPARE (",V.length,")"]}):e.jsx(S,{variant:"ghost",size:"small",className:"saved-sidebar__section-link",onClick:()=>{E(!1),P([])},children:"Cancel"}):e.jsx(S,{variant:"ghost",size:"small",className:"saved-sidebar__section-link",onClick:()=>E(!0),iconLeft:e.jsx(se,{size:14}),children:"COMPARE"}))})]}),w&&e.jsx("p",{className:"saved-sidebar__compare-hint",children:"Select 2-3 vehicles to compare"}),e.jsx("div",{className:"saved-sidebar__vehicles",children:D.map(s=>{const r=p(s.name),_=V.includes(s.id);return e.jsxs("div",{className:`saved-sidebar__vehicle-wrapper ${w?"saved-sidebar__vehicle-wrapper--with-checkbox":""} ${_?"saved-sidebar__vehicle-wrapper--selected":""}`,children:[w&&e.jsx("button",{className:`saved-sidebar__compare-checkbox ${_?"saved-sidebar__compare-checkbox--checked":""}`,onClick:()=>K(s.id),"aria-label":_?"Remove from compare":"Add to compare",children:_&&e.jsx(le,{size:14})}),e.jsxs(I,{to:r?`/${r.slug}`:"/vehicles",className:"saved-sidebar__vehicle",onClick:m=>{w?(m.preventDefault(),K(s.id)):n()},children:[e.jsx("div",{className:"saved-sidebar__vehicle-image",children:r?.image?e.jsx(W,{src:r.image,alt:s.name,width:80,height:60}):e.jsx("div",{className:"saved-sidebar__vehicle-placeholder",children:e.jsx(ee,{size:24})})}),e.jsxs("div",{className:"saved-sidebar__vehicle-info",children:[e.jsx("span",{className:"saved-sidebar__vehicle-name",children:s.name}),e.jsxs("div",{className:"saved-sidebar__vehicle-meta",children:[r&&e.jsxs("span",{className:"saved-sidebar__vehicle-price",children:["$",r.priceMin.toLocaleString()]}),r?.staffRating&&e.jsxs("span",{className:"saved-sidebar__vehicle-rating",children:[e.jsx(ie,{size:12,fill:"currentColor"}),e.jsx("span",{children:r.staffRating.toFixed(1)}),e.jsx("span",{className:"saved-sidebar__vehicle-rating-label",children:"C/D"})]})]})]}),!w&&e.jsx("button",{className:"saved-sidebar__vehicle-unsave",onClick:m=>{m.preventDefault(),m.stopPropagation(),H(s.id)},"aria-label":"Remove from saved",title:"Remove from saved",children:e.jsx(B,{size:18,fill:"currentColor"})})]}),r&&!w&&e.jsxs("button",{className:"saved-sidebar__vehicle-dealers",onClick:()=>{Q({year:parseInt(r.year,10),make:r.make,model:r.model,msrp:r.priceMin,image:r.image,galleryImages:r.galleryImages,priceMin:r.priceMin,priceMax:r.priceMax}),q(!0)},children:[e.jsx(Fe,{size:14}),e.jsx("span",{children:"See cars available near you"}),e.jsx(_e,{size:14})]})]},s.id)})})]}):!d&&e.jsxs("div",{className:"saved-sidebar__empty",children:[e.jsx(B,{size:48,className:"saved-sidebar__empty-icon"}),e.jsx("h3",{className:"saved-sidebar__empty-title",children:"No saved vehicles"}),e.jsx("p",{className:"saved-sidebar__empty-desc",children:'Use the "Add a Vehicle" button below to search and save vehicles you want.'}),e.jsxs(I,{to:"/vehicles",className:"saved-sidebar__empty-cta",onClick:n,children:["Browse All Vehicles ",e.jsx(_e,{size:16})]})]}),d?e.jsxs("div",{className:"saved-sidebar__add-vehicle",children:[e.jsxs("div",{className:"saved-sidebar__search-wrapper",children:[e.jsx(te,{size:18,className:"saved-sidebar__search-icon"}),e.jsx("input",{ref:Z,type:"text",className:"saved-sidebar__search-input",placeholder:"Search by year, make, or model...",value:u,onChange:fe}),e.jsx("button",{className:"saved-sidebar__search-close",onClick:()=>{j(!1),R(""),O([])},children:e.jsx(Y,{size:18})})]}),G.length>0&&e.jsx("div",{className:"saved-sidebar__search-results",children:G.map(s=>e.jsxs("button",{className:"saved-sidebar__search-result",onClick:()=>be(s),children:[e.jsx("div",{className:"saved-sidebar__search-result-image",children:e.jsx(W,{src:s.image,alt:`${s.year} ${s.make} ${s.model}`,width:60,height:45})}),e.jsxs("div",{className:"saved-sidebar__search-result-info",children:[e.jsxs("span",{className:"saved-sidebar__search-result-name",children:[s.year," ",s.make," ",s.model]}),e.jsxs("span",{className:"saved-sidebar__search-result-price",children:["$",s.priceMin.toLocaleString()," - $",s.priceMax.toLocaleString()]})]}),e.jsx(ae,{size:18,className:"saved-sidebar__search-result-add"})]},s.id))}),u.length>=2&&G.length===0&&e.jsxs("div",{className:"saved-sidebar__search-no-results",children:['No vehicles found for "',u,'"']})]}):e.jsx(S,{variant:"outline",className:"saved-sidebar__add-btn",onClick:()=>j(!0),iconLeft:e.jsx(ae,{size:18}),children:"Add a Vehicle"})]}),x==="own"&&e.jsxs("div",{className:"saved-sidebar__section",children:[T.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"saved-sidebar__section-header",children:e.jsxs("span",{className:"saved-sidebar__section-title",children:["Cars I Own (",T.length,")"]})}),e.jsx("div",{className:"saved-sidebar__vehicles",children:T.map(s=>{const r=p(s.name);return e.jsxs(I,{to:r?`/${r.slug}`:"/vehicles",className:"saved-sidebar__vehicle",onClick:n,children:[e.jsx("div",{className:"saved-sidebar__vehicle-image",children:r?.image?e.jsx(W,{src:r.image,alt:s.name,width:80,height:60}):e.jsx("div",{className:"saved-sidebar__vehicle-placeholder",children:e.jsx(ee,{size:24})})}),e.jsxs("div",{className:"saved-sidebar__vehicle-info",children:[e.jsx("span",{className:"saved-sidebar__vehicle-name",children:s.name}),e.jsxs("div",{className:"saved-sidebar__vehicle-meta",children:[r&&e.jsxs("span",{className:"saved-sidebar__vehicle-price",children:["$",r.priceMin.toLocaleString()]}),r?.staffRating&&e.jsxs("span",{className:"saved-sidebar__vehicle-rating",children:[e.jsx(ie,{size:12,fill:"currentColor"}),e.jsx("span",{children:r.staffRating.toFixed(1)}),e.jsx("span",{className:"saved-sidebar__vehicle-rating-label",children:"C/D"})]})]})]}),e.jsx("button",{className:"saved-sidebar__vehicle-unsave",onClick:_=>{_.preventDefault(),_.stopPropagation(),H(s.id)},"aria-label":"Remove from saved",title:"Remove from saved",children:e.jsx(B,{size:18,fill:"currentColor"})})]},s.id)})})]}),T.length===0&&!y&&e.jsxs("div",{className:"saved-sidebar__empty",children:[e.jsx(ee,{size:48,className:"saved-sidebar__empty-icon"}),e.jsx("h3",{className:"saved-sidebar__empty-title",children:"No vehicles added"}),e.jsx("p",{className:"saved-sidebar__empty-desc",children:'Use the "Add a Vehicle" button below to add cars you own.'})]}),y?e.jsxs("div",{className:"saved-sidebar__add-vehicle",children:[e.jsxs("div",{className:"saved-sidebar__search-wrapper",children:[e.jsx(te,{size:18,className:"saved-sidebar__search-icon"}),e.jsx("input",{ref:F,type:"text",className:"saved-sidebar__search-input",placeholder:"Search by year, make, or model...",value:b,onChange:ce}),e.jsx("button",{className:"saved-sidebar__search-close",onClick:()=>{a(!1),o(""),z([])},children:e.jsx(Y,{size:18})})]}),C.length>0&&e.jsx("div",{className:"saved-sidebar__search-results",children:C.map(s=>e.jsxs("button",{className:"saved-sidebar__search-result",onClick:()=>je(s),children:[e.jsx("div",{className:"saved-sidebar__search-result-image",children:e.jsx(W,{src:s.image,alt:`${s.year} ${s.make} ${s.model}`,width:60,height:45})}),e.jsxs("div",{className:"saved-sidebar__search-result-info",children:[e.jsxs("span",{className:"saved-sidebar__search-result-name",children:[s.year," ",s.make," ",s.model]}),e.jsxs("span",{className:"saved-sidebar__search-result-price",children:["$",s.priceMin.toLocaleString()," - $",s.priceMax.toLocaleString()]})]}),e.jsx(ae,{size:18,className:"saved-sidebar__search-result-add"})]},s.id))}),b.length>=2&&C.length===0&&e.jsxs("div",{className:"saved-sidebar__search-no-results",children:['No vehicles found for "',b,'"']})]}):e.jsx(S,{variant:"outline",className:"saved-sidebar__add-btn",onClick:()=>a(!0),iconLeft:e.jsx(ae,{size:18}),children:"Add a Vehicle"})]})]}),e.jsx("div",{className:"saved-sidebar__footer",children:e.jsx(S,{as:"a",href:"/account?tab=saved",variant:"primary",fullWidth:!0,className:"saved-sidebar__footer-btn",onClick:n,children:"View All Saved"})})]}),A&&e.jsx(Re,{isOpen:ne,onClose:()=>{q(!1),Q(null)},vehicle:A}),e.jsx(ge,{isOpen:U,onClose:()=>{J(!1),E(!1),P([])},vehicles:Ne()})]})};xe.__docgenInfo={description:"",methods:[],displayName:"SavedVehiclesSidebar",props:{isOpen:{required:!0,tsType:{name:"boolean"},description:""},onClose:{required:!0,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""}}};const qe=()=>{const t=we(),n=ye(),{user:c,isAuthenticated:M,signOut:H}=ve(),[x,h]=l.useState(!1),[f,$]=l.useState(""),[y,a]=l.useState([]),[d,j]=l.useState(!1),[b,o]=l.useState(-1),[u,R]=l.useState(!1),[C,z]=l.useState(!1),[G,O]=l.useState(!1),F=l.useRef(null),Z=l.useRef(null),{getRating:ne}=Ve(),q="https://d2kde5ohu8qb21.cloudfront.net/files/659f9ed490e84500088bd486/012-2024-lamborghini-revuelto.jpg",A=l.useMemo(()=>{const i=t.pathname.match(/^\/(\d{4})\/([^/]+)\/([^/]+)/);if(i){const[,p,D,T]=i,ce=`${p}/${D}/${T}`;return Se(ce)}return null},[t.pathname]),Q=A?.image||(A?q:void 0),w=i=>ne(i.id,Le(i.bodyStyle),i.staffRating),E=[{label:"Browse All Vehicles",href:"/vehicles",isRoute:!0},{label:"Shop New Cars",href:"/",isRoute:!0},{label:"Shop Used Cars",href:"/used-cars",isRoute:!0},{label:"Research Cars",href:"#"},{label:"Expert Reviews",href:"#"},{label:"What's My Car Worth?",href:"/whats-my-car-worth",isRoute:!0},{label:"News + Stories",href:"/news"}];l.useEffect(()=>{if(f.trim().length>=2){const i=ke(f).slice(0,8);a(i),j(!0)}else a([]),j(!1);o(-1)},[f]),l.useEffect(()=>{const i=p=>{F.current&&!F.current.contains(p.target)&&j(!1),Z.current&&!Z.current.contains(p.target)&&z(!1)};return document.addEventListener("mousedown",i),()=>document.removeEventListener("mousedown",i)},[]);const V=async()=>{await H(),z(!1),n("/")},P=i=>{i.preventDefault(),f.trim()&&(n(`/vehicles?search=${encodeURIComponent(f.trim())}`),$(""),j(!1))},U=i=>{n(`/${i.slug}`),$(""),j(!1)},J=i=>{!d||y.length===0||(i.key==="ArrowDown"?(i.preventDefault(),o(p=>p<y.length-1?p+1:p)):i.key==="ArrowUp"?(i.preventDefault(),o(p=>p>0?p-1:-1)):i.key==="Enter"&&b>=0?(i.preventDefault(),U(y[b])):i.key==="Escape"&&j(!1))};return e.jsxs("header",{className:"header",children:[e.jsxs("div",{className:"header__container",children:[e.jsxs("div",{className:"header__top",children:[e.jsx("button",{className:"header__mobile-menu-btn",onClick:()=>h(!x),"aria-label":x?"Close menu":"Open menu",children:x?e.jsx(Y,{size:24}):e.jsx(De,{size:24})}),e.jsx(I,{to:"/",className:"header__logo","aria-label":"Car and Driver Home",children:e.jsxs("svg",{viewBox:"0 0 1364 262",className:"header__logo-svg header__logo-svg--animated",xmlns:"http://www.w3.org/2000/svg",children:[e.jsx("path",{className:"header__logo-letter",fill:"currentColor",d:"M68.022 210.901C74.858 210.901 76.91 205.432 76.91 197.571V146.641H132.626V199.276C132.626 231.41 116.903 261.83 72.468 261.83H62.554C15.04 261.83 0 233.462 0 194.496V65.289C0 28.712 16.408 0 62.213 0H72.468C117.588 0 132.626 25.978 132.626 59.473V101.177H76.91V61.869C76.91 53.667 74.858 49.222 67.682 49.222C60.502 49.222 58.452 52.982 58.452 61.869V197.571C58.452 206.114 60.846 210.901 68.022 210.901Z"}),e.jsx("path",{className:"header__logo-letter",fill:"currentColor",d:"M272.324 257.729H217.63L213.53 220.47H187.551L183.791 257.729H134.911L167.384 3.41907H236.774L272.324 257.729ZM192.681 170.223H208.402L200.54 92.9747L192.681 170.223Z"}),e.jsx("path",{className:"header__logo-letter",fill:"currentColor",d:"M366.797 3.41907C391.752 3.41907 408.842 18.1158 408.842 48.1925V81.6935C408.842 105.278 396.534 115.873 386.624 120.318C396.194 124.079 408.842 134.331 408.842 153.477V237.561C408.842 247.13 410.55 252.601 412.258 256.021V257.729H356.542C354.149 254.654 352.101 248.844 352.101 239.616V165.781C352.101 157.237 350.047 153.477 342.527 153.477H334.666V257.729H278.268V3.41907H366.797ZM334.665 105.623H341.845C349.021 105.623 352.1 102.203 352.1 93.3126V59.1349C352.1 50.245 350.391 47.1691 342.871 47.1691H334.666L334.665 105.623Z"}),e.jsx("path",{className:"header__logo-bar",d:"M428.499 63.023H594.769V3.61597H428.5L428.499 63.023Z",fill:"#D2232A"}),e.jsx("path",{className:"header__logo-bar",d:"M428.499 257.046H594.769V197.644H428.5L428.499 257.046Z",fill:"#0061AF"}),e.jsx("path",{className:"header__logo-letter",fill:"currentColor",d:"M481.039 182.672H461.599L460.098 167.332H449.987L448.607 182.672H430.7L442.597 77.9894H468.019L481.039 182.672ZM451.864 147.839H458.219L454.742 111.882L451.864 147.839Z"}),e.jsx("path",{className:"header__logo-letter",fill:"currentColor",d:"M486.974 182.672V77.9889H507.008L517.652 128.64V77.9889H535.31V182.671H517.152L504.881 128.077V182.672H486.974Z"}),e.jsx("path",{className:"header__logo-letter",fill:"currentColor",d:"M573.909 77.9874C585.429 77.9875 592.567 84.3239 592.567 101.067V158.609C592.567 174.929 586.18 182.672 574.035 182.672H544.356V77.9874H573.909ZM564.175 162.549H567.647C570.653 162.549 571.531 160.579 571.531 156.219V103.459C571.531 99.2341 570.653 97.4093 567.898 97.4093H564.175V162.549Z"}),e.jsx("path",{className:"header__logo-letter",fill:"currentColor",d:"M696.341 3.41907C727.79 3.41907 747.273 18.8019 747.273 59.4728V199.276C747.273 238.928 729.839 257.729 696.682 257.729H615.674V3.41907H696.341ZM671.389 208.852H679.251C687.454 208.852 689.847 204.065 689.847 193.469V65.2892C689.847 55.0342 687.453 50.589 679.933 50.589H671.389V208.852Z"}),e.jsx("path",{className:"header__logo-letter",fill:"currentColor",d:"M845.438 3.41907C870.393 3.41907 887.48 18.1158 887.48 48.1925V81.6935C887.48 105.278 875.177 115.873 865.264 120.318C874.833 124.079 887.48 134.331 887.48 153.477V237.561C887.48 247.13 889.191 252.601 890.899 256.021V257.729H835.183C832.79 254.654 830.738 248.844 830.738 239.616V165.781C830.738 157.237 828.689 153.477 821.169 153.477H813.307L813.308 257.729H756.907V3.41907H845.438ZM813.307 105.623H820.482C827.662 105.623 830.737 102.203 830.737 93.3126V59.1349C830.737 50.245 829.03 47.1691 821.51 47.1691H813.307V105.623Z"}),e.jsx("path",{className:"header__logo-letter",fill:"currentColor",d:"M956.492 257.732H900.092V3.41895H956.492V257.732Z"}),e.jsx("path",{className:"header__logo-letter",fill:"currentColor",d:"M1073.15 257.729H999.319L962.748 3.41895H1022.22L1037.6 162.705L1052.99 3.41895H1107.34L1073.15 257.729Z"}),e.jsx("path",{className:"header__logo-letter",fill:"currentColor",d:"M1113.59 257.729V3.41895H1219.21V56.0569H1169.3V99.4689H1209.3V153.477H1169.3V204.065H1221.26V257.729H1113.59Z"}),e.jsx("path",{className:"header__logo-letter",fill:"currentColor",d:"M1285.45 47.1689H1293.65C1301.17 47.1689 1302.88 50.2449 1302.88 59.1349V93.313C1302.88 102.203 1299.81 105.623 1292.63 105.623H1285.45V47.1689ZM1285.45 153.477H1293.31C1300.83 153.477 1302.88 157.237 1302.88 165.781V239.616C1302.88 248.844 1304.93 254.654 1307.33 257.729H1363.04V256.021C1361.33 252.601 1359.62 247.131 1359.62 237.561V153.477C1359.62 134.331 1346.98 124.08 1337.41 120.319C1347.32 115.874 1359.62 105.279 1359.62 81.6939V48.1929C1359.62 18.1159 1342.54 3.41895 1317.58 3.41895H1229.05V257.729H1285.45V153.477Z"})]})}),e.jsxs("form",{className:"header__search-bar",onSubmit:P,ref:F,children:[e.jsx("input",{type:"text",className:"header__search-input",placeholder:"Search vehicles...",value:f,onChange:i=>$(i.target.value),onKeyDown:J,onFocus:()=>f.trim().length>=2&&j(!0)}),e.jsx("button",{type:"submit",className:"header__search-btn","aria-label":"Search",children:e.jsx(te,{size:20})}),d&&y.length>0&&e.jsxs("div",{className:"header__suggestions",children:[y.map((i,p)=>e.jsxs("div",{className:`header__suggestion ${p===b?"header__suggestion--active":""}`,children:[e.jsx("img",{src:i.image||"/placeholder-car.png",alt:`${i.make} ${i.model}`,className:"header__suggestion-image",onClick:()=>U(i)}),e.jsxs("div",{className:"header__suggestion-info",onClick:()=>U(i),children:[e.jsxs("span",{className:"header__suggestion-name",children:[i.year," ",i.make," ",i.model]}),e.jsx("span",{className:"header__suggestion-price",children:i.priceRange})]}),e.jsxs("span",{className:"header__suggestion-rating",children:[e.jsx("span",{className:"header__suggestion-rating-score",children:w(i)}),"/10"]}),e.jsxs("div",{className:"header__suggestion-ctas",children:[e.jsx("button",{type:"button",className:"header__suggestion-cta header__suggestion-cta--buy",onClick:()=>{n(`/${i.slug}#pricing`),$(""),j(!1)},children:"Buy"}),e.jsx("button",{type:"button",className:"header__suggestion-cta header__suggestion-cta--research",onClick:()=>U(i),children:"Research"})]})]},i.id)),e.jsxs("button",{type:"submit",className:"header__suggestion header__suggestion--all",children:[e.jsx(te,{size:16}),e.jsxs("span",{children:['See all results for "',f,'"']})]})]})]}),e.jsxs("div",{className:"header__actions",children:[M?e.jsxs("button",{className:"header__saved-btn",onClick:()=>O(!0),"aria-label":"My Garage",children:[e.jsx(B,{size:18,fill:"currentColor"}),e.jsx("span",{className:"header__saved-btn-text",children:"My Garage"})]}):e.jsx(S,{variant:"primary",size:"small",onClick:()=>R(!0),className:"header__subscribe-btn",children:"Subscribe"}),e.jsx("div",{className:"header__user-container",ref:Z,children:M&&c?e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"header__user-btn header__user-btn--authenticated",onClick:()=>z(!C),"aria-label":"User menu","aria-expanded":C,children:e.jsx("div",{className:"header__user-avatar",children:re(c.avatar)?e.jsx("img",{src:re(c.avatar),alt:c.name||"User avatar",className:"header__user-avatar-img"}):e.jsx("span",{children:pe(c.name)})})}),C&&e.jsxs("div",{className:"header__user-menu",children:[e.jsxs("div",{className:"header__user-menu-header",children:[e.jsx("div",{className:"header__user-menu-avatar",children:re(c.avatar)?e.jsx("img",{src:re(c.avatar),alt:c.name||"User avatar",className:"header__user-menu-avatar-img"}):e.jsx("span",{children:pe(c.name)})}),e.jsxs("div",{className:"header__user-menu-info",children:[e.jsx("span",{className:"header__user-menu-name",children:c.name||"Member"}),e.jsx("span",{className:"header__user-menu-email",children:c.email})]})]}),e.jsx("div",{className:"header__user-menu-divider"}),e.jsxs(I,{to:"/account",className:"header__user-menu-item",onClick:()=>z(!1),children:[e.jsx(Ze,{size:18}),e.jsx("span",{children:"My Account"})]}),e.jsx("div",{className:"header__user-menu-divider"}),e.jsxs("button",{className:"header__user-menu-item header__user-menu-item--danger",onClick:V,children:[e.jsx(Oe,{size:18}),e.jsx("span",{children:"Sign Out"})]})]})]}):e.jsx(I,{to:"/sign-in",className:"header__user-btn","aria-label":"Sign in",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",fill:"none",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M21.649 19.875c-1.428-2.468-3.629-4.239-6.196-5.078a6.75 6.75 0 1 0-6.906 0c-2.568.839-4.768 2.609-6.196 5.078a.75.75 0 1 0 1.299.75C5.416 17.573 8.538 15.75 12 15.75c3.462 0 6.584 1.823 8.35 4.875a.75.75 0 1 0 1.299-.75ZM6.749 9a5.25 5.25 0 1 1 10.5 0 5.25 5.25 0 0 1-10.5 0Z",fill:"currentColor"})})})})]})]}),e.jsx("nav",{className:`header__nav ${x?"header__nav--open":""}`,children:e.jsx("ul",{className:"header__nav-list",children:E.map((i,p)=>e.jsx("li",{className:"header__nav-item",children:i.isRoute?e.jsx(I,{to:i.href,className:"header__nav-link",children:i.label}):e.jsx("a",{href:i.href,className:"header__nav-link",children:i.label})},p))})})]}),e.jsx($e,{isOpen:u,onClose:()=>R(!1),vehicleName:A?`${A.year} ${A.make} ${A.model}`:void 0,vehicleImage:Q,enableExitIntent:!0}),e.jsx(xe,{isOpen:G,onClose:()=>O(!1)})]})};qe.__docgenInfo={description:"",methods:[],displayName:"Header"};export{qe as H,ys as a};

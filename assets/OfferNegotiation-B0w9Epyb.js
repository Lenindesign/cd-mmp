import{r as u,j as e}from"./iframe-BqD4V8Qv.js";import{f as n,S as D,M}from"./dealerService-BucHFuvR.js";import{X as q}from"./x-CzCrOUtd.js";import{D as A}from"./dollar-sign-BkzFHTC8.js";import{A as _}from"./arrow-right-Bheh08tv.js";import{c as f}from"./createLucideIcon-Czx444dS.js";import{C as h}from"./circle-check-big-CnfxW7Qy.js";import{C as j}from"./clock-tl-wjtAe.js";const R=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],o=f("circle-x",R);const $=[["path",{d:"m11 17 2 2a1 1 0 1 0 3-3",key:"efffak"}],["path",{d:"m14 14 2.5 2.5a1 1 0 1 0 3-3l-3.88-3.88a3 3 0 0 0-4.24 0l-.88.88a1 1 0 1 1-3-3l2.81-2.81a5.79 5.79 0 0 1 7.06-.87l.47.28a2 2 0 0 0 1.42.25L21 4",key:"9pr0kb"}],["path",{d:"m21 3 1 11h-2",key:"1tisrp"}],["path",{d:"M3 3 2 14l6.5 6.5a1 1 0 1 0 3-3",key:"1uvwmv"}],["path",{d:"M3 4h8",key:"1ep09j"}]],E=f("handshake",$),F=({negotiation:t,onSendCounter:N,onAcceptOffer:y,onRejectOffer:v,onSendMessage:b,onClose:C})=>{const[c,p]=u.useState(t.currentOffer),[a,r]=u.useState(""),[k,l]=u.useState(!1),i=t.messages.filter(s=>s.sender==="dealer"&&(s.type==="offer"||s.type==="counter")).pop(),w=t.status==="countered"||t.status==="pending",z=()=>{c>0&&(N(c,a||void 0),l(!1),r(""))},g=()=>{a.trim()&&(b(a),r(""))},O=()=>{switch(t.status){case"pending":return e.jsxs("span",{className:"negotiation__status negotiation__status--pending",children:[e.jsx(j,{size:14})," Pending"]});case"countered":return e.jsxs("span",{className:"negotiation__status negotiation__status--countered",children:[e.jsx(_,{size:14})," Counter Received"]});case"accepted":return e.jsxs("span",{className:"negotiation__status negotiation__status--accepted",children:[e.jsx(h,{size:14})," Accepted"]});case"rejected":return e.jsxs("span",{className:"negotiation__status negotiation__status--rejected",children:[e.jsx(o,{size:14})," Declined"]});case"expired":return e.jsxs("span",{className:"negotiation__status negotiation__status--expired",children:[e.jsx(j,{size:14})," Expired"]});default:return null}},S=s=>{const d=new Date().getTime()-s.getTime(),m=Math.floor(d/6e4),x=Math.floor(d/36e5),T=Math.floor(d/864e5);return m<1?"Just now":m<60?`${m}m ago`:x<24?`${x}h ago`:`${T}d ago`};return e.jsxs("div",{className:"negotiation",children:[e.jsxs("header",{className:"negotiation__header",children:[e.jsx("button",{className:"negotiation__close",onClick:C,"aria-label":"Close",children:e.jsx(q,{size:20})}),O(),e.jsxs("div",{className:"negotiation__header-content",children:[e.jsx("h2",{className:"negotiation__title",children:"Offer Negotiation"}),e.jsxs("p",{className:"negotiation__vehicle",children:[t.vehicle.year," ",t.vehicle.make," ",t.vehicle.model]}),e.jsx("p",{className:"negotiation__dealer",children:t.dealerName})]})]}),e.jsxs("div",{className:"negotiation__summary",children:[e.jsxs("div",{className:"negotiation__summary-item",children:[e.jsx("span",{className:"negotiation__summary-label",children:"MSRP"}),e.jsx("span",{className:"negotiation__summary-value",children:n(t.vehicle.msrp)})]}),e.jsx("div",{className:"negotiation__summary-divider"}),e.jsxs("div",{className:"negotiation__summary-item",children:[e.jsx("span",{className:"negotiation__summary-label",children:"Your Offer"}),e.jsx("span",{className:"negotiation__summary-value negotiation__summary-value--highlight",children:n(t.initialOffer)})]}),i&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"negotiation__summary-divider"}),e.jsxs("div",{className:"negotiation__summary-item",children:[e.jsx("span",{className:"negotiation__summary-label",children:"Dealer Counter"}),e.jsx("span",{className:"negotiation__summary-value negotiation__summary-value--counter",children:n(i.amount||0)})]})]})]}),e.jsx("div",{className:"negotiation__messages",children:t.messages.map(s=>e.jsxs("div",{className:`negotiation__message negotiation__message--${s.sender}`,children:[e.jsxs("div",{className:"negotiation__message-content",children:[s.type==="offer"&&e.jsxs("div",{className:"negotiation__message-offer",children:[e.jsx(A,{size:16}),e.jsxs("span",{children:["Offered ",e.jsx("strong",{children:n(s.amount||0)})]})]}),s.type==="counter"&&e.jsxs("div",{className:"negotiation__message-counter",children:[e.jsx(_,{size:16}),e.jsxs("span",{children:["Counter offer: ",e.jsx("strong",{children:n(s.amount||0)})]})]}),s.type==="accepted"&&e.jsxs("div",{className:"negotiation__message-accepted",children:[e.jsx(E,{size:16}),e.jsx("span",{children:"Offer accepted!"})]}),s.type==="rejected"&&e.jsxs("div",{className:"negotiation__message-rejected",children:[e.jsx(o,{size:16}),e.jsx("span",{children:"Offer declined"})]}),s.message&&e.jsx("p",{className:"negotiation__message-text",children:s.message})]}),e.jsx("span",{className:"negotiation__message-time",children:S(s.timestamp)})]},s.id))}),t.status==="accepted"&&e.jsxs("div",{className:"negotiation__success",children:[e.jsx(h,{size:48}),e.jsx("h3",{children:"Congratulations!"}),e.jsxs("p",{children:["Your offer of ",e.jsx("strong",{children:n(t.currentOffer)})," has been accepted."]}),e.jsx("p",{children:"The dealer will contact you shortly to finalize the purchase."})]}),t.status==="rejected"&&e.jsxs("div",{className:"negotiation__rejected",children:[e.jsx(o,{size:48}),e.jsx("h3",{children:"Offer Declined"}),e.jsx("p",{children:"Unfortunately, the dealer was unable to accept your offer."}),e.jsx("p",{children:"You can try submitting a new offer or contact the dealer directly."})]}),w&&e.jsx("div",{className:"negotiation__actions",children:k?e.jsxs("div",{className:"negotiation__counter-form",children:[e.jsxs("div",{className:"negotiation__counter-header",children:[e.jsx("h4",{children:"Send Counter Offer"}),e.jsx("button",{className:"negotiation__counter-cancel",onClick:()=>l(!1),children:"Cancel"})]}),e.jsxs("div",{className:"negotiation__counter-input",children:[e.jsx("span",{className:"negotiation__input-prefix",children:"$"}),e.jsx("input",{type:"number",value:c,onChange:s=>p(Number(s.target.value)),placeholder:"Enter amount"})]}),e.jsx("textarea",{className:"negotiation__counter-message",value:a,onChange:s=>r(s.target.value),placeholder:"Add a message (optional)",rows:2}),e.jsxs("button",{className:"negotiation__btn negotiation__btn--primary",onClick:z,children:[e.jsx(D,{size:16}),"Send Counter"]})]}):e.jsxs(e.Fragment,{children:[i&&e.jsxs("div",{className:"negotiation__response-options",children:[e.jsxs("p",{className:"negotiation__response-prompt",children:["The dealer countered with ",e.jsx("strong",{children:n(i.amount||0)})]}),e.jsxs("div",{className:"negotiation__response-buttons",children:[e.jsxs("button",{className:"negotiation__btn negotiation__btn--accept",onClick:y,children:[e.jsx(h,{size:16}),"Accept Offer"]}),e.jsxs("button",{className:"negotiation__btn negotiation__btn--counter",onClick:()=>{p(i.amount||t.currentOffer),l(!0)},children:[e.jsx(_,{size:16}),"Counter"]}),e.jsxs("button",{className:"negotiation__btn negotiation__btn--reject",onClick:v,children:[e.jsx(o,{size:16}),"Decline"]})]})]}),e.jsxs("div",{className:"negotiation__message-input",children:[e.jsx("input",{type:"text",value:a,onChange:s=>r(s.target.value),placeholder:"Send a message...",onKeyDown:s=>{s.key==="Enter"&&!s.shiftKey&&(s.preventDefault(),g())}}),e.jsx("button",{className:"negotiation__send-btn",onClick:g,disabled:!a.trim(),children:e.jsx(M,{size:18})})]})]})})]})};F.__docgenInfo={description:"",methods:[],displayName:"OfferNegotiation",props:{negotiation:{required:!0,tsType:{name:"NegotiationData"},description:""},onSendCounter:{required:!0,tsType:{name:"signature",type:"function",raw:"(amount: number, message?: string) => void",signature:{arguments:[{type:{name:"number"},name:"amount"},{type:{name:"string"},name:"message"}],return:{name:"void"}}},description:""},onAcceptOffer:{required:!0,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},onRejectOffer:{required:!0,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},onSendMessage:{required:!0,tsType:{name:"signature",type:"function",raw:"(message: string) => void",signature:{arguments:[{type:{name:"string"},name:"message"}],return:{name:"void"}}},description:""},onClose:{required:!0,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""}}};export{F as O};

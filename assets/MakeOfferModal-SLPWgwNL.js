import{r as l,j as e}from"./iframe-CgUoK-hQ.js";import{f as t}from"./dealerService-CeBNsEgh.js";import{X as V}from"./x-bi8nA3M3.js";import{C as R}from"./car-6Y3oKaaK.js";import{D as H}from"./dollar-sign-DTx8annB.js";import{M as U}from"./message-square-gXpPSfRQ.js";import{U as W}from"./user-BmTsGj7S.js";import{M as X}from"./mail-pkapEGFj.js";import{P as J}from"./phone-DlPIP5zM.js";import{C as Q}from"./circle-check-big-8Zi6vtxw.js";import{S as G}from"./send-CbXdzNPw.js";const K=({isOpen:C,onClose:S,dealer:d,vehicle:a,onSubmitOffer:w})=>{const[o,f]=l.useState("offer"),[n,b]=l.useState(Math.round(a.msrp*.95)),[i,q]=l.useState(!1),[m,I]=l.useState(0),[u,M]=l.useState(""),[_,O]=l.useState(!1),[v,D]=l.useState(0),[g,$]=l.useState(""),[p,P]=l.useState(""),[c,F]=l.useState(""),[h,T]=l.useState(""),[r,x]=l.useState({});if(!C)return null;const z=[{label:"MSRP",amount:a.msrp,discount:0},{label:"3% Below",amount:Math.round(a.msrp*.97),discount:3},{label:"5% Below",amount:Math.round(a.msrp*.95),discount:5},{label:"8% Below",amount:Math.round(a.msrp*.92),discount:8}],y=n-(i?m:0),j=a.msrp-n,E=(j/a.msrp*100).toFixed(1),A=()=>{const s={};return n<=0&&(s.offerAmount="Please enter a valid offer amount"),i&&!u.trim()&&(s.tradeInDescription="Please describe your trade-in vehicle"),x(s),Object.keys(s).length===0},Y=()=>{const s={};return p.trim()||(s.name="Name is required"),c.trim()?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(c)||(s.email="Please enter a valid email"):s.email="Email is required",h.trim()||(s.phone="Phone is required"),x(s),Object.keys(s).length===0},k=()=>{o==="offer"&&A()?f("contact"):o==="contact"&&Y()&&B()},B=()=>{const s={dealerId:d.id,dealerName:d.name,vehicleInfo:{year:a.year,make:a.make,model:a.model,trim:a.trim},offerAmount:n,msrp:a.msrp,customerInfo:{name:p,email:c,phone:h},message:g||void 0,tradeIn:i?{hasTradeIn:!0,estimatedValue:m,vehicleDescription:u}:void 0,financing:_?{needsFinancing:!0,downPayment:v}:void 0};w(s),f("success")},N=()=>{f("offer"),x({}),S()};return e.jsx("div",{className:"offer-modal__overlay",onClick:N,children:e.jsxs("div",{className:"offer-modal",onClick:s=>s.stopPropagation(),children:[e.jsx("button",{className:"offer-modal__close",onClick:N,"aria-label":"Close",children:e.jsx(V,{size:24})}),e.jsxs("header",{className:"offer-modal__header",children:[e.jsx("h2",{className:"offer-modal__title",children:o==="success"?"Offer Submitted!":"Make an Offer"}),e.jsx("p",{className:"offer-modal__subtitle",children:o==="success"?`Your offer has been sent to ${d.name}`:`${a.year} ${a.make} ${a.model}${a.trim?` ${a.trim}`:""}`})]}),o!=="success"&&e.jsxs("div",{className:"offer-modal__progress",children:[e.jsxs("div",{className:`offer-modal__step ${o==="offer"?"offer-modal__step--active":""}`,children:[e.jsx("span",{className:"offer-modal__step-number",children:"1"}),e.jsx("span",{className:"offer-modal__step-label",children:"Your Offer"})]}),e.jsx("div",{className:"offer-modal__step-divider"}),e.jsxs("div",{className:`offer-modal__step ${o==="contact"?"offer-modal__step--active":""}`,children:[e.jsx("span",{className:"offer-modal__step-number",children:"2"}),e.jsx("span",{className:"offer-modal__step-label",children:"Contact Info"})]})]}),o==="offer"&&e.jsxs("div",{className:"offer-modal__content",children:[e.jsxs("div",{className:"offer-modal__msrp-ref",children:[e.jsx(R,{size:18}),e.jsxs("span",{children:["MSRP: ",e.jsx("strong",{children:t(a.msrp)})]})]}),e.jsxs("div",{className:"offer-modal__quick-offers",children:[e.jsx("label",{className:"offer-modal__label",children:"Quick Select"}),e.jsx("div",{className:"offer-modal__quick-buttons",children:z.map(s=>e.jsxs("button",{type:"button",className:`offer-modal__quick-btn ${n===s.amount?"offer-modal__quick-btn--active":""}`,onClick:()=>b(s.amount),children:[e.jsx("span",{className:"offer-modal__quick-label",children:s.label}),e.jsx("span",{className:"offer-modal__quick-amount",children:t(s.amount)}),s.discount>0&&e.jsxs("span",{className:"offer-modal__quick-savings",children:["Save ",s.discount,"%"]})]},s.label))})]}),e.jsxs("div",{className:"offer-modal__field",children:[e.jsxs("label",{className:"offer-modal__label",htmlFor:"offer-amount",children:[e.jsx(H,{size:16}),"Your Offer"]}),e.jsxs("div",{className:"offer-modal__input-wrapper",children:[e.jsx("span",{className:"offer-modal__input-prefix",children:"$"}),e.jsx("input",{id:"offer-amount",type:"number",className:`offer-modal__input ${r.offerAmount?"offer-modal__input--error":""}`,value:n,onChange:s=>b(Number(s.target.value)),min:0})]}),r.offerAmount&&e.jsx("span",{className:"offer-modal__error",children:r.offerAmount}),j>0&&e.jsxs("span",{className:"offer-modal__savings",children:[E,"% below MSRP (",t(j)," savings)"]})]}),e.jsxs("div",{className:"offer-modal__section",children:[e.jsxs("label",{className:"offer-modal__checkbox-label",children:[e.jsx("input",{type:"checkbox",checked:i,onChange:s=>q(s.target.checked)}),e.jsx("span",{children:"I have a trade-in"})]}),i&&e.jsxs("div",{className:"offer-modal__trade-in",children:[e.jsxs("div",{className:"offer-modal__field",children:[e.jsx("label",{className:"offer-modal__label",htmlFor:"trade-value",children:"Estimated Value"}),e.jsxs("div",{className:"offer-modal__input-wrapper",children:[e.jsx("span",{className:"offer-modal__input-prefix",children:"$"}),e.jsx("input",{id:"trade-value",type:"number",className:"offer-modal__input",value:m,onChange:s=>I(Number(s.target.value)),min:0})]})]}),e.jsxs("div",{className:"offer-modal__field",children:[e.jsx("label",{className:"offer-modal__label",htmlFor:"trade-desc",children:"Vehicle Description"}),e.jsx("input",{id:"trade-desc",type:"text",className:`offer-modal__input ${r.tradeInDescription?"offer-modal__input--error":""}`,value:u,onChange:s=>M(s.target.value),placeholder:"e.g., 2019 Honda Civic EX, 45k miles"}),r.tradeInDescription&&e.jsx("span",{className:"offer-modal__error",children:r.tradeInDescription})]})]})]}),e.jsxs("div",{className:"offer-modal__section",children:[e.jsxs("label",{className:"offer-modal__checkbox-label",children:[e.jsx("input",{type:"checkbox",checked:_,onChange:s=>O(s.target.checked)}),e.jsx("span",{children:"I need financing"})]}),_&&e.jsxs("div",{className:"offer-modal__field",children:[e.jsx("label",{className:"offer-modal__label",htmlFor:"down-payment",children:"Down Payment"}),e.jsxs("div",{className:"offer-modal__input-wrapper",children:[e.jsx("span",{className:"offer-modal__input-prefix",children:"$"}),e.jsx("input",{id:"down-payment",type:"number",className:"offer-modal__input",value:v,onChange:s=>D(Number(s.target.value)),min:0})]})]})]}),e.jsxs("div",{className:"offer-modal__field",children:[e.jsxs("label",{className:"offer-modal__label",htmlFor:"message",children:[e.jsx(U,{size:16}),"Message (Optional)"]}),e.jsx("textarea",{id:"message",className:"offer-modal__textarea",value:g,onChange:s=>$(s.target.value),placeholder:"Any additional details or questions for the dealer...",rows:3})]}),i&&m>0&&e.jsxs("div",{className:"offer-modal__summary",children:[e.jsxs("div",{className:"offer-modal__summary-row",children:[e.jsx("span",{children:"Your Offer"}),e.jsx("span",{children:t(n)})]}),e.jsxs("div",{className:"offer-modal__summary-row offer-modal__summary-row--trade",children:[e.jsx("span",{children:"Trade-In Credit"}),e.jsxs("span",{children:["-",t(m)]})]}),e.jsxs("div",{className:"offer-modal__summary-row offer-modal__summary-row--total",children:[e.jsx("span",{children:"Net Amount"}),e.jsx("span",{children:t(y)})]})]})]}),o==="contact"&&e.jsxs("div",{className:"offer-modal__content",children:[e.jsxs("div",{className:"offer-modal__offer-summary",children:[e.jsx("span",{children:"Your offer:"}),e.jsx("strong",{children:t(n)}),i&&m>0&&e.jsxs("span",{className:"offer-modal__trade-note",children:["(Net: ",t(y)," with trade-in)"]})]}),e.jsxs("div",{className:"offer-modal__field",children:[e.jsxs("label",{className:"offer-modal__label",htmlFor:"name",children:[e.jsx(W,{size:16}),"Full Name"]}),e.jsx("input",{id:"name",type:"text",className:`offer-modal__input ${r.name?"offer-modal__input--error":""}`,value:p,onChange:s=>P(s.target.value),placeholder:"John Smith"}),r.name&&e.jsx("span",{className:"offer-modal__error",children:r.name})]}),e.jsxs("div",{className:"offer-modal__field",children:[e.jsxs("label",{className:"offer-modal__label",htmlFor:"email",children:[e.jsx(X,{size:16}),"Email"]}),e.jsx("input",{id:"email",type:"email",className:`offer-modal__input ${r.email?"offer-modal__input--error":""}`,value:c,onChange:s=>F(s.target.value),placeholder:"john@example.com"}),r.email&&e.jsx("span",{className:"offer-modal__error",children:r.email})]}),e.jsxs("div",{className:"offer-modal__field",children:[e.jsxs("label",{className:"offer-modal__label",htmlFor:"phone",children:[e.jsx(J,{size:16}),"Phone"]}),e.jsx("input",{id:"phone",type:"tel",className:`offer-modal__input ${r.phone?"offer-modal__input--error":""}`,value:h,onChange:s=>T(s.target.value),placeholder:"(555) 123-4567"}),r.phone&&e.jsx("span",{className:"offer-modal__error",children:r.phone})]}),e.jsxs("p",{className:"offer-modal__disclaimer",children:["By submitting, you agree to be contacted by ",d.name," regarding this offer."]})]}),o==="success"&&e.jsxs("div",{className:"offer-modal__content offer-modal__content--success",children:[e.jsx("div",{className:"offer-modal__success-icon",children:e.jsx(Q,{size:64})}),e.jsx("h3",{className:"offer-modal__success-title",children:"Offer Sent Successfully!"}),e.jsxs("p",{className:"offer-modal__success-text",children:["Your offer of ",e.jsx("strong",{children:t(n)})," has been sent to ",d.name,"."]}),e.jsxs("p",{className:"offer-modal__success-text",children:["The dealer will review your offer and respond within 24-48 hours. Check your email at ",e.jsx("strong",{children:c})," for updates."]}),e.jsxs("div",{className:"offer-modal__success-next",children:[e.jsx("h4",{children:"What happens next?"}),e.jsxs("ol",{children:[e.jsx("li",{children:"Dealer reviews your offer"}),e.jsx("li",{children:"They may accept, counter, or ask questions"}),e.jsx("li",{children:"You'll receive updates via email"}),e.jsx("li",{children:"Finalize the deal at the dealership"})]})]})]}),e.jsxs("footer",{className:"offer-modal__footer",children:[o==="offer"&&e.jsx("button",{className:"offer-modal__btn offer-modal__btn--primary",onClick:k,children:"Continue to Contact Info"}),o==="contact"&&e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"offer-modal__btn offer-modal__btn--secondary",onClick:()=>f("offer"),children:"Back"}),e.jsxs("button",{className:"offer-modal__btn offer-modal__btn--primary",onClick:k,children:[e.jsx(G,{size:18}),"Submit Offer"]})]}),o==="success"&&e.jsx("button",{className:"offer-modal__btn offer-modal__btn--primary",onClick:N,children:"Done"})]})]})})};K.__docgenInfo={description:"",methods:[],displayName:"MakeOfferModal",props:{isOpen:{required:!0,tsType:{name:"boolean"},description:""},onClose:{required:!0,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},dealer:{required:!0,tsType:{name:"DealerWithScore"},description:""},vehicle:{required:!0,tsType:{name:"signature",type:"object",raw:`{
  year: number;
  make: string;
  model: string;
  trim?: string;
  msrp: number;
}`,signature:{properties:[{key:"year",value:{name:"number",required:!0}},{key:"make",value:{name:"string",required:!0}},{key:"model",value:{name:"string",required:!0}},{key:"trim",value:{name:"string",required:!1}},{key:"msrp",value:{name:"number",required:!0}}]}},description:""},onSubmitOffer:{required:!0,tsType:{name:"signature",type:"function",raw:"(offer: OfferData) => void",signature:{arguments:[{type:{name:"OfferData"},name:"offer"}],return:{name:"void"}}},description:""}}};export{K as M};

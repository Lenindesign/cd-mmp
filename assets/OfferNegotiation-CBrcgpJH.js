import{r as u,j as e}from"./iframe-DcgZJ2Uo.js";import{f as n}from"./dealerService-CeBNsEgh.js";import{X as k}from"./x-BB0Nz_97.js";import{D}from"./dollar-sign-Cl_PQzZD.js";import{A as _}from"./arrow-right-DWKCQdrl.js";import{H as M,C as o}from"./handshake-CSuZl7Rs.js";import{C as g}from"./circle-check-big-Bc_EXM6d.js";import{S as A}from"./send-ptctvyG1.js";import{M as q}from"./message-square-B9-RtHw3.js";import{C as j}from"./clock-DRyvOrK2.js";const R=({negotiation:t,onSendCounter:f,onAcceptOffer:N,onRejectOffer:v,onSendMessage:y,onClose:C})=>{const[c,p]=u.useState(t.currentOffer),[a,r]=u.useState(""),[b,l]=u.useState(!1),i=t.messages.filter(s=>s.sender==="dealer"&&(s.type==="offer"||s.type==="counter")).pop(),w=t.status==="countered"||t.status==="pending",z=()=>{c>0&&(f(c,a||void 0),l(!1),r(""))},h=()=>{a.trim()&&(y(a),r(""))},O=()=>{switch(t.status){case"pending":return e.jsxs("span",{className:"negotiation__status negotiation__status--pending",children:[e.jsx(j,{size:14})," Pending"]});case"countered":return e.jsxs("span",{className:"negotiation__status negotiation__status--countered",children:[e.jsx(_,{size:14})," Counter Received"]});case"accepted":return e.jsxs("span",{className:"negotiation__status negotiation__status--accepted",children:[e.jsx(g,{size:14})," Accepted"]});case"rejected":return e.jsxs("span",{className:"negotiation__status negotiation__status--rejected",children:[e.jsx(o,{size:14})," Declined"]});case"expired":return e.jsxs("span",{className:"negotiation__status negotiation__status--expired",children:[e.jsx(j,{size:14})," Expired"]});default:return null}},S=s=>{const d=new Date().getTime()-s.getTime(),m=Math.floor(d/6e4),x=Math.floor(d/36e5),T=Math.floor(d/864e5);return m<1?"Just now":m<60?`${m}m ago`:x<24?`${x}h ago`:`${T}d ago`};return e.jsxs("div",{className:"negotiation",children:[e.jsxs("header",{className:"negotiation__header",children:[e.jsx("button",{className:"negotiation__close",onClick:C,"aria-label":"Close",children:e.jsx(k,{size:20})}),O(),e.jsxs("div",{className:"negotiation__header-content",children:[e.jsx("h2",{className:"negotiation__title",children:"Offer Negotiation"}),e.jsxs("p",{className:"negotiation__vehicle",children:[t.vehicle.year," ",t.vehicle.make," ",t.vehicle.model]}),e.jsx("p",{className:"negotiation__dealer",children:t.dealerName})]})]}),e.jsxs("div",{className:"negotiation__summary",children:[e.jsxs("div",{className:"negotiation__summary-item",children:[e.jsx("span",{className:"negotiation__summary-label",children:"MSRP"}),e.jsx("span",{className:"negotiation__summary-value",children:n(t.vehicle.msrp)})]}),e.jsx("div",{className:"negotiation__summary-divider"}),e.jsxs("div",{className:"negotiation__summary-item",children:[e.jsx("span",{className:"negotiation__summary-label",children:"Your Offer"}),e.jsx("span",{className:"negotiation__summary-value negotiation__summary-value--highlight",children:n(t.initialOffer)})]}),i&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"negotiation__summary-divider"}),e.jsxs("div",{className:"negotiation__summary-item",children:[e.jsx("span",{className:"negotiation__summary-label",children:"Dealer Counter"}),e.jsx("span",{className:"negotiation__summary-value negotiation__summary-value--counter",children:n(i.amount||0)})]})]})]}),e.jsx("div",{className:"negotiation__messages",children:t.messages.map(s=>e.jsxs("div",{className:`negotiation__message negotiation__message--${s.sender}`,children:[e.jsxs("div",{className:"negotiation__message-content",children:[s.type==="offer"&&e.jsxs("div",{className:"negotiation__message-offer",children:[e.jsx(D,{size:16}),e.jsxs("span",{children:["Offered ",e.jsx("strong",{children:n(s.amount||0)})]})]}),s.type==="counter"&&e.jsxs("div",{className:"negotiation__message-counter",children:[e.jsx(_,{size:16}),e.jsxs("span",{children:["Counter offer: ",e.jsx("strong",{children:n(s.amount||0)})]})]}),s.type==="accepted"&&e.jsxs("div",{className:"negotiation__message-accepted",children:[e.jsx(M,{size:16}),e.jsx("span",{children:"Offer accepted!"})]}),s.type==="rejected"&&e.jsxs("div",{className:"negotiation__message-rejected",children:[e.jsx(o,{size:16}),e.jsx("span",{children:"Offer declined"})]}),s.message&&e.jsx("p",{className:"negotiation__message-text",children:s.message})]}),e.jsx("span",{className:"negotiation__message-time",children:S(s.timestamp)})]},s.id))}),t.status==="accepted"&&e.jsxs("div",{className:"negotiation__success",children:[e.jsx(g,{size:48}),e.jsx("h3",{children:"Congratulations!"}),e.jsxs("p",{children:["Your offer of ",e.jsx("strong",{children:n(t.currentOffer)})," has been accepted."]}),e.jsx("p",{children:"The dealer will contact you shortly to finalize the purchase."})]}),t.status==="rejected"&&e.jsxs("div",{className:"negotiation__rejected",children:[e.jsx(o,{size:48}),e.jsx("h3",{children:"Offer Declined"}),e.jsx("p",{children:"Unfortunately, the dealer was unable to accept your offer."}),e.jsx("p",{children:"You can try submitting a new offer or contact the dealer directly."})]}),w&&e.jsx("div",{className:"negotiation__actions",children:b?e.jsxs("div",{className:"negotiation__counter-form",children:[e.jsxs("div",{className:"negotiation__counter-header",children:[e.jsx("h4",{children:"Send Counter Offer"}),e.jsx("button",{className:"negotiation__counter-cancel",onClick:()=>l(!1),children:"Cancel"})]}),e.jsxs("div",{className:"negotiation__counter-input",children:[e.jsx("span",{className:"negotiation__input-prefix",children:"$"}),e.jsx("input",{type:"number",value:c,onChange:s=>p(Number(s.target.value)),placeholder:"Enter amount"})]}),e.jsx("textarea",{className:"negotiation__counter-message",value:a,onChange:s=>r(s.target.value),placeholder:"Add a message (optional)",rows:2}),e.jsxs("button",{className:"negotiation__btn negotiation__btn--primary",onClick:z,children:[e.jsx(A,{size:16}),"Send Counter"]})]}):e.jsxs(e.Fragment,{children:[i&&e.jsxs("div",{className:"negotiation__response-options",children:[e.jsxs("p",{className:"negotiation__response-prompt",children:["The dealer countered with ",e.jsx("strong",{children:n(i.amount||0)})]}),e.jsxs("div",{className:"negotiation__response-buttons",children:[e.jsxs("button",{className:"negotiation__btn negotiation__btn--accept",onClick:N,children:[e.jsx(g,{size:16}),"Accept Offer"]}),e.jsxs("button",{className:"negotiation__btn negotiation__btn--counter",onClick:()=>{p(i.amount||t.currentOffer),l(!0)},children:[e.jsx(_,{size:16}),"Counter"]}),e.jsxs("button",{className:"negotiation__btn negotiation__btn--reject",onClick:v,children:[e.jsx(o,{size:16}),"Decline"]})]})]}),e.jsxs("div",{className:"negotiation__message-input",children:[e.jsx("input",{type:"text",value:a,onChange:s=>r(s.target.value),placeholder:"Send a message...",onKeyDown:s=>{s.key==="Enter"&&!s.shiftKey&&(s.preventDefault(),h())}}),e.jsx("button",{className:"negotiation__send-btn",onClick:h,disabled:!a.trim(),children:e.jsx(q,{size:18})})]})]})})]})};R.__docgenInfo={description:"",methods:[],displayName:"OfferNegotiation",props:{negotiation:{required:!0,tsType:{name:"NegotiationData"},description:""},onSendCounter:{required:!0,tsType:{name:"signature",type:"function",raw:"(amount: number, message?: string) => void",signature:{arguments:[{type:{name:"number"},name:"amount"},{type:{name:"string"},name:"message"}],return:{name:"void"}}},description:""},onAcceptOffer:{required:!0,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},onRejectOffer:{required:!0,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},onSendMessage:{required:!0,tsType:{name:"signature",type:"function",raw:"(message: string) => void",signature:{arguments:[{type:{name:"string"},name:"message"}],return:{name:"void"}}},description:""},onClose:{required:!0,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""}}};export{R as O};
